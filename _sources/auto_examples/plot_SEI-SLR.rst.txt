
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples\plot_SEI-SLR.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_SEI-SLR.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_SEI-SLR.py:


==========================================
Sampling states from the SEI-SLR algorithm
==========================================
The example runs the SEI-SLR algorithm to generate states uniformly distributed on the selection event.

.. GENERATED FROM PYTHON SOURCE LINES 7-14

.. code-block:: default


    import PSILOGIT
    import numpy as np
    from PSILOGIT.tools import *
    from sklearn.linear_model import LogisticRegression, LogisticRegressionCV
    import matplotlib.pyplot as plt








.. GENERATED FROM PYTHON SOURCE LINES 15-16

We build a model with a randomly generated dataset.

.. GENERATED FROM PYTHON SOURCE LINES 16-23

.. code-block:: default

    n = 10
    p = 15
    theta = np.zeros(p)
    lamb = 2
    model = PSILOGIT.PSILOGIT(truetheta=theta, regularization=lamb,  n=n, p=p)









.. GENERATED FROM PYTHON SOURCE LINES 24-25

We run the SEI-SLR algorithm.

.. GENERATED FROM PYTHON SOURCE LINES 25-30

.. code-block:: default

    def linear_temperature(t):
        return 0.2/np.log(t+1)
    states, ls_FNR, energies = model.SEI_SLR(total_length_SEISLR_path=100000, backup_start_time=2000, temperature=linear_temperature, repulsing_force=True, random_start=True, conditioning_signs=False, seed=0)






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

      0%|          | 0/100000 [00:00<?, ?it/s]




.. GENERATED FROM PYTHON SOURCE LINES 31-32

The size of the observed vector is small enough to compute exactly the states belonging to the selection event via an exhaustive search.

.. GENERATED FROM PYTHON SOURCE LINES 32-37

.. code-block:: default

    nbM_admissibles, ls_states_admissibles = model.compute_selection_event(compare_with_energy=True)
    print('Size of the selection event: ', len(ls_states_admissibles))







.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Size of the selection event:  22




.. GENERATED FROM PYTHON SOURCE LINES 38-42

By running over the~$2^{10}$ possible vectors :math:`Y \in \{ 0,1\}^N`, we have previously computed exactly the selection event.
In the following, we identify each vector :math:`Y \in \{0, 1\}^N` with the number between~$0$ and~$2^N-1=1024$ that it represents in the base-2 numeral system.
The following figure shows the last :math:`500,000` visited states for our simulated annealing path. On the vertical axis, we have the integers encoded by all possible vectors :math:`Y \in \{0,1\}^N`. 
The red dashed lines represent the states that belong to the selection event :math:`E_M`. While crosses are showing the visited states on the last :math:`500,000` time steps of the path, green crosses are emphasizing the ones that belong to the selection event.

.. GENERATED FROM PYTHON SOURCE LINES 42-45

.. code-block:: default

    model.last_visited_states(states, ls_states_admissibles)
    plt.show()




.. image-sg:: /auto_examples/images/sphx_glr_plot_SEI-SLR_001.png
   :alt: plot SEI SLR
   :srcset: /auto_examples/images/sphx_glr_plot_SEI-SLR_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 46-48

The following figure shows that the SEI-SLR algorithm covers properly the selection event without being stuck in one specific state of :math:`E_{M}`. 
The simulated annealing path is jumping from one state of :math:`E_{M}` to another, ending up with an asymptotic distribution of the visited states that approximates the uniform distribution on :math:`E_{M}`.

.. GENERATED FROM PYTHON SOURCE LINES 48-49

.. code-block:: default

    model.histo_time_in_selection_event(states, ls_states_admissibles, rotation_angle=80)
    plt.show()


.. image-sg:: /auto_examples/images/sphx_glr_plot_SEI-SLR_002.png
   :alt: plot SEI SLR
   :srcset: /auto_examples/images/sphx_glr_plot_SEI-SLR_002.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  45.231 seconds)


.. _sphx_glr_download_auto_examples_plot_SEI-SLR.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example


    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_SEI-SLR.py <plot_SEI-SLR.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_SEI-SLR.ipynb <plot_SEI-SLR.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
