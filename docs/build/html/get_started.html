<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="API Documentation" href="api.html" /><link rel="prev" title="PSILOGIT" href="index.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2022.06.21"/>
        <title>Get started - SIGLE documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">SIGLE  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">SIGLE  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Get started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="api.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.Sampling.html">PSILOGIT.Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.tools.html">PSILOGIT.tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.Figures.html">PSILOGIT.Figures</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.Methods.Methods.html">PSILOGIT.Methods.Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.Methods.Weak.Weak.html">PSILOGIT.Methods.Weak.Weak</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.Methods.Sigle.Sigle.html">PSILOGIT.Methods.Sigle.Sigle</a></li>
<li class="toctree-l2"><a class="reference internal" href="generated/PSILOGIT.Methods.Taylor.Taylor.html">PSILOGIT.Methods.Taylor.Taylor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="auto_examples/index.html">Examples Gallery</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/plot_SEI-SLR.html">Sampling states from the SEI-SLR algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/plot_SIGLE_in_2d.html">Visualization of SIGLE in the selected model</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto_examples/plot_cdf-pvalues.html">CDF of p-values</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="get-started">
<h1>Get started<a class="headerlink" href="#get-started" title="Permalink to this headline">#</a></h1>
<p>In this starter example, we will toy datasets.</p>
<p>Beforehand, make sure to install <code class="docutils literal notranslate"><span class="pre">PSILOGIT</span></code>.</p>
<section id="generate-a-toy-dataset">
<h2>Generate a toy dataset<a class="headerlink" href="#generate-a-toy-dataset" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PSILOGIT</span></code> allows to consider toy examples with randomly generated parameters or to specify by hand the parameters of the model.</p>
<ol class="arabic simple">
<li><p><strong>Toy example with randomly generated parameters</strong></p></li>
</ol>
<p>The following code will create an instance of the PSILOGIT class using random generators.
We specify the true parameter vector <span class="math notranslate nohighlight">\(\vartheta \in \mathbb R^p\)</span> and the regularization parameter <span class="math notranslate nohighlight">\(\lambda\)</span> for the <span class="math notranslate nohighlight">\(\ell_1\)</span>-penalty.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">PSILOGIT</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PSILOGIT.tools</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># model built with a randomly generated dataset</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">p</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">lamb</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PSILOGIT</span><span class="o">.</span><span class="n">PSILOGIT</span><span class="p">(</span><span class="n">truetheta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">regularization</span><span class="o">=</span><span class="n">lamb</span><span class="p">,</span>  <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple" start="2">
<li><p><strong>Specifying the parameters of the model</strong></p></li>
</ol>
<p>The following code will create an instance of the PSILOGIT class using specified parameter.</p>
<p>2.1. Specifying the design matrix <span class="math notranslate nohighlight">\(X\)</span>, the selected support <span class="math notranslate nohighlight">\(M\)</span> and the vector of signs <span class="math notranslate nohighlight">\(S_M\)</span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">PSILOGIT</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">PSILOGIT.tools</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># model built with specified parameters</span>
<span class="n">lamb</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="mi">10</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="n">LR</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">lamb</span><span class="p">,</span> <span class="n">penalty</span><span class="o">=</span><span class="s1">&#39;l1&#39;</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="s1">&#39;liblinear&#39;</span><span class="p">,</span> <span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">yobs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">LR</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">yobs</span><span class="p">)</span>
<span class="n">theta_obs</span> <span class="o">=</span> <span class="n">LR</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta_obs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">1e-5</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">SM</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">theta_obs</span><span class="p">[</span><span class="n">M</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PSILOGIT</span><span class="o">.</span><span class="n">PSILOGIT</span><span class="p">(</span><span class="n">regularizaition</span><span class="o">=</span><span class="n">lamb</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="n">M</span><span class="p">,</span> <span class="n">SM</span><span class="o">=</span><span class="n">SM</span><span class="p">)</span>
</pre></div>
</div>
<p>2.2. Specifying only the design matrix <span class="math notranslate nohighlight">\(X\)</span>.</p>
<p>One needs to specify the true parameter vector <span class="math notranslate nohighlight">\(\vartheta\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># imports</span>
<span class="kn">import</span> <span class="nn">PSILOGIT</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">PSILOGIT.tools</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># model built with a specified design and parameter vector</span>
<span class="n">lamb</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span><span class="p">,</span><span class="n">p</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span><span class="mi">10</span>
<span class="n">truetheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">PSILOGIT</span><span class="o">.</span><span class="n">PSILOGIT</span><span class="p">(</span><span class="n">regularizaition</span><span class="o">=</span><span class="n">lamb</span><span class="p">,</span> <span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span> <span class="n">truetheta</span><span class="o">=</span><span class="n">truetheta</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that to allow reproducibility of the experiments, the random seed is fixed to <span class="math notranslate nohighlight">\(1\)</span> and can be modified using the optional parameter ‘seed’ of the function <code class="docutils literal notranslate"><span class="pre">PSILOGIT.PSILOGIT</span></code>.</p>
</section>
<section id="sampling-states-from-the-selection-event">
<h2>Sampling states from the selection event<a class="headerlink" href="#sampling-states-from-the-selection-event" title="Permalink to this headline">#</a></h2>
<p>In order to use the SIGLE procedures, one needs to sample states from the distribution of observations conditional to the selection event. In our paper, we proposed two different approaches to achieve this goal:</p>
<ul class="simple">
<li><p>a simple rejection sampling method,</p></li>
<li><p>the SEI-SLR algorithm.</p></li>
</ul>
<blockquote>
<div><p>Depending on the context, it is more convenient to use one method or the other. In this short tutorial, the number of predictors <span class="math notranslate nohighlight">\(p=10\)</span> is small enough so that we can use the rejection sampling method.</p>
</div></blockquote>
</section>
<section id="hypothesis-testing">
<h2>Hypothesis testing<a class="headerlink" href="#hypothesis-testing" title="Permalink to this headline">#</a></h2>
<p>We consider the following composite hypothesis testing problem</p>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\mathbb H_0 : \; \theta^*=\theta_0^* \quad   VS   \quad \mathbb H_1 : \; \theta^*\neq \theta_0^*.\]</div>
</div>
<p>The following code allows to obtain the p-value associated to</p>
<ul class="simple">
<li><p>SIGLE in the selected and the saturated models</p></li>
<li><p>Bonferroni method (TT-Bonferroni) and simple method (TT-1): from Taylor &amp; Tibshirani</p></li>
<li><p>a weak learner</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example of vector of observations for which we want to provide a p-value</span>
<span class="n">observed_state</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">yobs</span>

<span class="c1"># Sampling under the null</span>
<span class="n">thetanull</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">signull</span> <span class="o">=</span> <span class="n">sigmoid</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">X</span> <span class="o">@</span> <span class="n">thetanull</span><span class="p">)</span>
<span class="n">statesnull</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">SEI_by_sampling</span><span class="p">(</span><span class="n">signull</span><span class="p">,</span> <span class="n">nb_ite</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">tildeGN12</span><span class="p">,</span> <span class="n">barpi</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">params_saturated</span><span class="p">(</span><span class="n">signull</span><span class="p">,</span> <span class="n">statesnull</span><span class="p">)</span>
<span class="n">SIGLEselec</span><span class="p">,</span> <span class="n">SIGLEsat</span><span class="p">,</span> <span class="n">gaps</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pval_SIGLE</span><span class="p">([</span><span class="n">observed_state</span><span class="p">],</span> <span class="n">barpi</span><span class="p">,</span> <span class="n">l2_regularization</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span> <span class="n">grad_descent</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lr&#39;</span><span class="p">:</span><span class="mf">0.01</span><span class="p">,</span><span class="s1">&#39;return_gaps&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;max_ite&#39;</span><span class="p">:</span><span class="mi">10000</span><span class="p">},</span>
                                                    <span class="n">calibrated_from_samples</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">statesnull</span><span class="o">=</span><span class="n">statesnull</span><span class="p">)</span>
<span class="n">gamma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">M</span><span class="p">))</span>
<span class="n">gamma</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">TT1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pval_taylor</span><span class="p">([</span><span class="n">observed_state</span><span class="p">],</span> <span class="n">thetanull</span><span class="o">=</span><span class="n">thetanull</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="n">gamma</span><span class="p">)</span>
<span class="n">TBon</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pval_taylor</span><span class="p">([</span><span class="n">observed_state</span><span class="p">],</span> <span class="n">thetanull</span><span class="o">=</span><span class="n">thetanull</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Bonferroni&#39;</span><span class="p">)</span>
<span class="n">Weak</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pval_weak_learner</span><span class="p">(</span><span class="n">statesnull</span><span class="p">,</span> <span class="p">[</span><span class="n">observed_state</span><span class="p">],</span> <span class="n">barpi</span><span class="p">,</span> <span class="n">signull</span><span class="o">=</span><span class="n">signull</span><span class="p">)</span>
<span class="n">lists_pvalues</span> <span class="o">=</span> <span class="p">[</span><span class="n">Weak</span><span class="p">,</span> <span class="n">TT1</span><span class="p">,</span> <span class="n">TBon</span><span class="p">,</span> <span class="n">SIGLEselec</span><span class="p">,</span> <span class="n">SIGLEsat</span><span class="p">]</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Weak learner&#39;</span><span class="p">,</span> <span class="s2">&quot;TT-1&quot;</span><span class="p">,</span> <span class="s1">&#39;TT-Bonferroni&#39;</span><span class="p">,</span> <span class="s1">&#39;SIGLE Selected&#39;</span><span class="p">,</span> <span class="s1">&#39;SIGLE Saturated&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">))],</span> <span class="p">[</span><span class="n">pval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">lists_pvalues</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">names</span><span class="p">))],</span> <span class="n">names</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;p-value&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="further-links">
<h2>Further links<a class="headerlink" href="#further-links" title="Permalink to this headline">#</a></h2>
<p>This was just a starter example. Get familiar with <code class="docutils literal notranslate"><span class="pre">PSILOGIT</span></code> by browsing its <a class="reference internal" href="api.html#api-documentation"><span class="std std-ref">API Documentation</span></a> or
explore the <a class="reference internal" href="auto_examples/index.html#examples-gallery"><span class="std std-ref">Examples Gallery</span></a>, which includes examples on real-life datasets as well as
timing comparison with other solvers.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="api.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">API Documentation</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Q.Duchemin &amp; Y.De Castro
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Get started</a><ul>
<li><a class="reference internal" href="#generate-a-toy-dataset">Generate a toy dataset</a></li>
<li><a class="reference internal" href="#sampling-states-from-the-selection-event">Sampling states from the selection event</a></li>
<li><a class="reference internal" href="#hypothesis-testing">Hypothesis testing</a></li>
<li><a class="reference internal" href="#further-links">Further links</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>